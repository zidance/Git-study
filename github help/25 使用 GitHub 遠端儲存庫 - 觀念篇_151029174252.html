<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>25 使用 GitHub 遠端儲存庫 - 觀念篇.markdown—/Users/Zidane/Documents/Learn-Git-in-30-days/docs</title>
    <style type="text/css">
    html{font-family: sans-serif;-ms-text-size-adjust: 100%;-webkit-text-size-adjust: 100%}body{margin: 0}article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display: block}audio,canvas,progress,video{display: inline-block;vertical-align: baseline}audio:not([controls]){display: none;height: 0}[hidden],template{display: none}a{background: transparent}a:active,a:hover{outline: 0}abbr[title]{border-bottom: 1px dotted}b,strong{font-weight: bold}dfn{font-style: italic}h1{font-size: 2em;margin: 0.67em 0}mark{background: #ff0;color: #000}small{font-size: 80%}sub,sup{font-size: 75%;line-height: 0;position: relative;vertical-align: baseline}sup{top: -0.5em}sub{bottom: -0.25em}img{border: 0}svg:not(:root){overflow: hidden}figure{margin: 1em 40px}hr{box-sizing: content-box;height: 0}pre{overflow: auto}code,kbd,pre,samp{font-family: monospace, monospace;font-size: 1em}button,input,optgroup,select,textarea{color: inherit;font: inherit;margin: 0}button{overflow: visible}button,select{text-transform: none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance: button;cursor: pointer}button[disabled],html input[disabled]{cursor: default}button::-moz-focus-inner,input::-moz-focus-inner{border: 0;padding: 0}input{line-height: normal}input[type="checkbox"],input[type="radio"]{box-sizing: border-box;padding: 0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height: auto}input[type="search"]{-webkit-appearance: textfield;box-sizing: content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance: none}fieldset{border: 1px solid #c0c0c0;margin: 0 2px;padding: 0.35em 0.625em 0.75em}legend{border: 0;padding: 0}textarea{overflow: auto}optgroup{font-weight: bold}table{border-collapse: collapse;border-spacing: 0}td,th{padding: 0}*{box-sizing: border-box}input,select,textarea,button{font: 13px/1.4 Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"}body{min-width: 1020px;font: 13px/1.4 Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";color: #333;background-color: #fff}a{color: #4183c4;text-decoration: none}a:hover,a:active{text-decoration: underline}hr,.rule{height: 0;margin: 15px 0;overflow: hidden;background: transparent;border: 0;border-bottom: 1px solid #ddd}hr:before,.rule:before{display: table;content: ""}hr:after,.rule:after{display: table;clear: both;content: ""}h1,h2,h3,h4,h5,h6{margin-top: 15px;margin-bottom: 15px;line-height: 1.1}h1{font-size: 30px}h2{font-size: 21px}h3{font-size: 16px}h4{font-size: 14px}h5{font-size: 12px}h6{font-size: 11px}small{font-size: 90%}blockquote{margin: 0}.lead{margin-bottom: 30px;font-size: 20px;font-weight: 300;color: #555}.text-muted{color: #999}.text-danger{color: #bd2c00}.text-emphasized{font-weight: bold;color: #333}ul,ol{padding: 0;margin-top: 0;margin-bottom: 0}ol ol,ul ol{list-style-type: lower-roman}ul ul ol,ul ol ol,ol ul ol,ol ol ol{list-style-type: lower-alpha}dd{margin-left: 0}tt,code{font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;font-size: 12px}pre{margin-top: 0;margin-bottom: 0;font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace}#realtime .status{overflow: visible;position: absolute;top: -5px;left: 0;background: url("/public/images/github-status.png");width: 26px;height: 26px;display: block;margin: 0 5px 0 0}#realtime .up{background-position: 0 0}#realtime .problem{background-position: 0 -53px}#realtime .down{background-position: 0 -26px}.container{max-width: 920px;margin: 0 auto 20px auto}#header{background: #FAFAFA;background: -moz-linear-gradient(#FAFAFA, #EAEAEA);background: -webkit-linear-gradient(#FAFAFA, #EAEAEA);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='#fafafa', endColorstr='#eaeaea')";border-bottom: 1px solid #CACACA;box-shadow: 0 1px 0 rgba(255, 255, 255, 0.4),0 0 10px rgba(0, 0, 0, 0.1)}#markup{padding: 3px}#markup article{padding-top: 30px}.markdown-body{overflow: hidden;font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;font-size: 16px;line-height: 1.6;word-wrap: break-word}.markdown-body>*:first-child{margin-top: 0 !important}.markdown-body>*:last-child{margin-bottom: 0 !important}.markdown-body .absent{color: #c00}.markdown-body .anchor{position: absolute;top: 0;left: 0;display: block;padding-right: 6px;padding-left: 30px;margin-left: -30px}.markdown-body .anchor:focus{outline: none}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position: relative;margin-top: 1em;margin-bottom: 16px;font-weight: bold;line-height: 1.4}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{display: none;color: #000;vertical-align: middle}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{padding-left: 8px;margin-left: -30px;text-decoration: none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{display: inline-block}.markdown-body h1 tt,.markdown-body h1 code,.markdown-body h2 tt,.markdown-body h2 code,.markdown-body h3 tt,.markdown-body h3 code,.markdown-body h4 tt,.markdown-body h4 code,.markdown-body h5 tt,.markdown-body h5 code,.markdown-body h6 tt,.markdown-body h6 code{font-size: inherit}.markdown-body h1{padding-bottom: 0.3em;font-size: 2.25em;line-height: 1.2;border-bottom: 1px solid #eee}.markdown-body h1 .anchor{line-height: 1}.markdown-body h2{padding-bottom: 0.3em;font-size: 1.75em;line-height: 1.225;border-bottom: 1px solid #eee}.markdown-body h2 .anchor{line-height: 1}.markdown-body h3{font-size: 1.5em;line-height: 1.43}.markdown-body h3 .anchor{line-height: 1.2}.markdown-body h4{font-size: 1.25em}.markdown-body h4 .anchor{line-height: 1.2}.markdown-body h5{font-size: 1em}.markdown-body h5 .anchor{line-height: 1.1}.markdown-body h6{font-size: 1em;color: #777}.markdown-body h6 .anchor{line-height: 1.1}.markdown-body p,.markdown-body blockquote,.markdown-body ul,.markdown-body ol,.markdown-body dl,.markdown-body table,.markdown-body pre{margin-top: 0;margin-bottom: 16px}.markdown-body hr{height: 4px;padding: 0;margin: 16px 0;background-color: #e7e7e7;border: 0 none}.markdown-body ul,.markdown-body ol{padding-left: 2em}.markdown-body ul.no-list,.markdown-body ol.no-list{padding: 0;list-style-type: none}.markdown-body ul ul,.markdown-body ul ol,.markdown-body ol ol,.markdown-body ol ul{margin-top: 0;margin-bottom: 0}.markdown-body li>p{margin-top: 16px}.markdown-body dl{padding: 0}.markdown-body dl dt{padding: 0;margin-top: 16px;font-size: 1em;font-style: italic;font-weight: bold}.markdown-body dl dd{padding: 0 16px;margin-bottom: 16px}.markdown-body blockquote{padding: 0 15px;color: #777;border-left: 4px solid #ddd}.markdown-body blockquote>:first-child{margin-top: 0}.markdown-body blockquote>:last-child{margin-bottom: 0}.markdown-body table{display: block;width: 100%;overflow: auto;word-break: normal;word-break: keep-all}.markdown-body table th{font-weight: bold}.markdown-body table th,.markdown-body table td{padding: 6px 13px;border: 1px solid #ddd}.markdown-body table tr{background-color: #fff;border-top: 1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color: #f8f8f8}.markdown-body img{max-width: 100%;box-sizing: border-box}.markdown-body span.frame{display: block;overflow: hidden}.markdown-body span.frame>span{display: block;float: left;width: auto;padding: 7px;margin: 13px 0 0;overflow: hidden;border: 1px solid #ddd}.markdown-body span.frame span img{display: block;float: left}.markdown-body span.frame span span{display: block;padding: 5px 0 0;clear: both;color: #333}.markdown-body span.align-center{display: block;overflow: hidden;clear: both}.markdown-body span.align-center>span{display: block;margin: 13px auto 0;overflow: hidden;text-align: center}.markdown-body span.align-center span img{margin: 0 auto;text-align: center}.markdown-body span.align-right{display: block;overflow: hidden;clear: both}.markdown-body span.align-right>span{display: block;margin: 13px 0 0;overflow: hidden;text-align: right}.markdown-body span.align-right span img{margin: 0;text-align: right}.markdown-body span.float-left{display: block;float: left;margin-right: 13px;overflow: hidden}.markdown-body span.float-left span{margin: 13px 0 0}.markdown-body span.float-right{display: block;float: right;margin-left: 13px;overflow: hidden}.markdown-body span.float-right>span{display: block;margin: 13px auto 0;overflow: hidden;text-align: right}.markdown-body code,.markdown-body tt{padding: 0;padding-top: 0.2em;padding-bottom: 0.2em;margin: 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px}.markdown-body code:before,.markdown-body code:after,.markdown-body tt:before,.markdown-body tt:after{letter-spacing: -0.2em;content: "\00a0"}.markdown-body code br,.markdown-body tt br{display: none}.markdown-body del code{text-decoration: inherit}.markdown-body pre>code{padding: 0;margin: 0;font-size: 100%;word-break: normal;white-space: pre;background: transparent;border: 0}.markdown-body .highlight{margin-bottom: 16px}.markdown-body .highlight pre,.markdown-body pre{padding: 16px;overflow: auto;font-size: 85%;line-height: 1.45;background-color: #f7f7f7;border-radius: 3px}.markdown-body .highlight pre{margin-bottom: 0;word-break: normal}.markdown-body pre{word-wrap: normal}.markdown-body pre code,.markdown-body pre tt{display: inline;max-width: initial;padding: 0;margin: 0;overflow: initial;line-height: inherit;word-wrap: normal;background-color: transparent;border: 0}.markdown-body pre code:before,.markdown-body pre code:after,.markdown-body pre tt:before,.markdown-body pre tt:after{content: normal}.markdown-body kbd{display: inline-block;padding: 3px 5px;font-size: 11px;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb}.codehilite{background: #ffffff}.codehilite .c{color: #999988;font-style: italic}.codehilite .err{color: #a61717;background-color: #e3d2d2}.codehilite .k{color: #000000;font-weight: bold}.codehilite .o{color: #000000;font-weight: bold}.codehilite .cm{color: #999988;font-style: italic}.codehilite .cp{color: #999999;font-weight: bold}.codehilite .c1{color: #999988;font-style: italic}.codehilite .cs{color: #999999;font-weight: bold;font-style: italic}.codehilite .gd{color: #000000;background-color: #ffdddd}.codehilite .gd .x{color: #000000;background-color: #ffaaaa}.codehilite .ge{color: #000000;font-style: italic}.codehilite .gr{color: #aa0000}.codehilite .gh{color: #999999}.codehilite .gi{color: #000000;background-color: #ddffdd}.codehilite .gi .x{color: #000000;background-color: #aaffaa}.codehilite .go{color: #888888}.codehilite .gp{color: #555555}.codehilite .gs{font-weight: bold}.codehilite .gu{color: #aaaaaa}.codehilite .gt{color: #aa0000}.codehilite .kc{color: #000000;font-weight: bold}.codehilite .kd{color: #000000;font-weight: bold}.codehilite .kp{color: #000000;font-weight: bold}.codehilite .kr{color: #000000;font-weight: bold}.codehilite .kt{color: #445588;font-weight: bold}.codehilite .m{color: #009999}.codehilite .s{color: #d14}.codehilite .na{color: #008080}.codehilite .nb{color: #0086B3}.codehilite .nc{color: #445588;font-weight: bold}.codehilite .no{color: #008080}.codehilite .ni{color: #800080}.codehilite .ne{color: #990000;font-weight: bold}.codehilite .nf{color: #990000;font-weight: bold}.codehilite .nn{color: #555555}.codehilite .nt{color: #000080}.codehilite .nv{color: #008080}.codehilite .ow{color: #000000;font-weight: bold}.codehilite .w{color: #bbbbbb}.codehilite .mf{color: #009999}.codehilite .mh{color: #009999}.codehilite .mi{color: #009999}.codehilite .mo{color: #009999}.codehilite .sb{color: #d14}.codehilite .sc{color: #d14}.codehilite .sd{color: #d14}.codehilite .s2{color: #d14}.codehilite .se{color: #d14}.codehilite .sh{color: #d14}.codehilite .si{color: #d14}.codehilite .sx{color: #d14}.codehilite .sr{color: #009926}.codehilite .s1{color: #d14}.codehilite .ss{color: #990073}.codehilite .bp{color: #999999}.codehilite .vc{color: #008080}.codehilite .vg{color: #008080}.codehilite .vi{color: #008080}.codehilite .il{color: #009999}
    </style>
    <style type="text/css">
      .markdown-body hr{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC")}
    </style>
  </head>
  <body>
    <div class="container">
      <div id="markup">
        <article id="content" class="markdown-body">
          <h1 id="25-github-">第 25 天：使用 GitHub 遠端儲存庫 - 觀念篇</h1>
<p>上一篇大家學會了如何下載遠端儲存庫 (<code>git clone</code>, <code>git pull</code>) 與上傳遠端儲存庫 (<code>git push</code>)，本篇文章來教大家認識遠端儲存庫的其他細節。</p>
<h2 id="_1">與遠端儲存庫有關的指令</h2>
<ul>
<li>
<p><code>git clone</code></p>
<p>將<strong>遠端儲存庫</strong>複製到本地，並建立<strong>工作目錄</strong>與<strong>本地儲存庫</strong> (就是 <code>.git</code> 資料夾)</p>
</li>
<li>
<p><code>git pull</code></p>
<p>將遠端儲存庫的最新版下載回來，下載的內容包含完整的物件儲存庫(object storage)。並且將遠端分支合併到本地分支。 (將 <code>origin/master</code> 遠端分支合併到 <code>master</code> 本地分支)</p>
<p>所以一個 <code>git pull</code> 動作，完全相等於以下兩段指令：</p>
<div class="codehilite"><pre>git fetch
git merge origin/master
</pre></div>


</li>
<li>
<p><code>git push</code></p>
<p>將本地儲存庫中目前分支的所有相關物件<strong>推送</strong>到遠端儲存庫中。</p>
</li>
<li>
<p><code>git fetch</code></p>
<p>將遠端儲存庫的最新版下載回來，下載的內容包含完整的物件儲存庫(object storage)。
這個命令<strong>不包含</strong>「合併」分支的動作。</p>
</li>
<li>
<p><code>git ls-remote</code></p>
<p>顯示特定遠端儲存庫的參照名稱。包含<strong>遠端分支</strong>與<strong>遠端標籤</strong>。</p>
</li>
</ul>
<h2 id="_2">關於追蹤分支的概念</h2>
<p>我們先前學習過關於「分支」的概念，不過僅限於｢本地分支｣，今天我們多出了個「遠端分支」，事情就相對複雜一些。</p>
<p>基本上，當我們的版本控管流程加上了遠端儲存庫之後，原本的<strong>分支</strong>就可以被拆成四種不同的概念：</p>
<ol>
<li>
<p>遠端追蹤分支</p>
<p>這個分支位於遠端，目的是用來追蹤分支的變化情形。通常遠端分支你是存取不到的。</p>
</li>
<li>
<p>本地追蹤分支</p>
<p>當你執行 <code>git clone</code> 複製一個遠端容器回來之後，所有遠端追蹤分支會被下載回來，並且相對應的建立起一個同名的 <strong>本地追蹤分支</strong>。</p>
<p>我們以複製 jQuery 在 GitHub 上的專案為例，透過 <code>git clone https://github.com/jquery/jquery.git</code> 下載回來後，執行 <code>git branch -a</code> 指令，顯示出所有「本地分支」與「本地追蹤分支」。「本地追蹤分支」就是如下圖<strong>紅字</strong>的部分：</p>
<p><img alt="image" src="https://f.cloud.github.com/assets/88981/1405811/8c59cc46-3d3f-11e3-9919-c71b5ccb87ca.png"></p>
</li>
<li>
<p>本地分支</p>
<p>在透過 <code>git branch</code> 指令執行時所顯示的分支，就是所謂的「本地分支」，這些分支存在於本地端，而這些分支又常被稱為 <strong>主題分支</strong> (Topic Branch) 或 <strong>開發分支</strong> (Development Branch)，就是因為這些分支預設不會被推送到遠端儲存庫，主要用來做開發用途。</p>
</li>
<li>
<p>遠端分支</p>
<p>顧名思義，遠端分支就是在遠端儲存庫中的分支，如此而已。如果你用 GitHub 的話，你是無法存取遠端分支的。</p>
<p>雖然說「概念上」可以分為這四類，但其實這些分支就只是<strong>參照名稱</strong>而已，而這裡的「追蹤分支」主要就是用來跟遠端的分支做對應，你不應該直接在這些分支上建立版本 (雖然你還是可以這麼做，但強烈不建議亂搞)，而是把這些「本地追蹤分支」視為是一種｢唯讀｣的分支。</p>
</li>
</ol>
<h2 id="_3">註冊遠端儲存庫</h2>
<p>我們在上一篇有提過可以透過 <code>git remote</code> 指令手動加入一個「遠端儲存庫」，例如：</p>
<div class="codehilite"><pre>git remote add origin https://github.com/doggy8088/sandbox-empty2.git
</pre></div>


<p>這個 <code>origin</code> 名稱是在 Git 版本控管中慣用的預設遠端分支的參照名稱，主要目的是用來代表一個遠端儲存庫的 URL 位址。</p>
<p>不過，事實上你可以在你的工作目錄中，建立多個遠端儲存庫的參照位址。例如我們以 <code>sandbox-empty2</code> 這個專案為例，我們先複製回來，然後透過 <code>git remote -v</code> 可列出目前註冊在工作目錄裡的遠端儲存庫資訊。如果我們額外將 jQuery 的遠端儲存庫也一併下載回來，則可以用以下指令先行註冊一個名稱起來。</p>
<div class="codehilite"><pre>git remote add jquery https://github.com/jquery/jquery.git
</pre></div>


<p>最後再用 <code>git fetch</code> 指令把完整的 jQuery 遠端儲存庫一併下載回來，完整的執行過程如下圖示：</p>
<p><img alt="image" src="https://f.cloud.github.com/assets/88981/1408254/d9fa10d4-3d7e-11e3-9c36-677d2e54efcd.png"></p>
<p>你可以看到，我們事實上可以在一個 Git 工作目錄中，加入許多相關或不相關的遠端儲存庫，這些複製回來的<strong>完整儲存庫</strong>，都包含了這些儲存庫中的所有物件與變更歷史，這些 Git 物件隨時都可以靈活運用。不過，通常我們註冊多個遠端儲存庫的機會並不多，除非你想抓特其他團隊成員的版本庫回來查看內容。</p>
<p>這些註冊進工作目錄的遠端儲存庫設定資訊，都儲存在 <code>.git\config</code> 設定檔中，其內容如下範例：</p>
<div class="codehilite"><pre>[remote &quot;origin&quot;]
    url = https://github.com/doggy8088/sandbox-empty2.git
    fetch = +refs/heads/*:refs/remotes/origin/*
[remote &quot;jquery&quot;]
    url = https://github.com/jquery/jquery.git
    fetch = +refs/heads/*:refs/remotes/jquery/*
</pre></div>


<p>這個 <code>[remote "origin"]</code> 區段的設定，包含了遠端儲存庫的代表名稱 <code>origin</code>，還有兩個重要的參數，分別是 <code>url</code> 與 <code>fetch</code> 這兩個，所代表的意思是：「遠端儲存庫 URL 位址在 <code>https://github.com/doggy8088/sandbox-empty2.git</code>，然後 <code>fetch</code> 所指定的則是一個<strong>參照名稱對應規格</strong>(refspec)。」</p>
<h2 id="refspec">何謂參照名稱對應規格 (refspec)</h2>
<p>我們先來看一下 refspec 的格式：</p>
<div class="codehilite"><pre>+refs/heads/*:refs/remotes/origin/*
</pre></div>


<p>這個格式概略區分成 4 塊：</p>
<ul>
<li>
<p><code>+</code></p>
<p>設定 <code>+</code> 加號，代表傳輸資料時，不會特別使用安全性確認機制。</p>
</li>
<li>
<p><code>refs/heads/*</code></p>
<p>「來源參照規格」，代表一個位於<strong>遠端儲存庫</strong>的<strong>遠端分支</strong>，而 <code>*</code> 星號代表 <code>refs/heads/</code> 這個路徑下｢所有的遠端參照」。</p>
</li>
<li>
<p><code>:</code></p>
<p>這用來區隔｢來源分支｣與「目的分支」</p>
</li>
<li>
<p><code>refs/remotes/origin/*</code></p>
<p>「目的參照規格」，代表一個位於<strong>本地儲存庫</strong>的<strong>本地追蹤分支</strong>，而 <code>*</code> 星號代表工作目錄的 <code>refs/remotes/origin/</code> 這個路徑下｢所有的本地參照」。</p>
</li>
</ul>
<p>當我們定義好這份 refspec 對應規格後，主要會影響到的是 <code>git fetch</code> 與 <code>git push</code> 這兩個遠端儲存庫的操作。</p>
<p><code>git fetch</code> 就是把遠端儲存庫的相關物件取回，但要取得那些遠端分支的物件呢？就是透過這份 refspec 的定義，他才知道的。以上述為例，當你執行 <code>git fetch</code> 或 <code>git fetch origin</code> 的時候，他會先透過 URL 連到遠端儲存庫，然後找出「來源參照規格」的那些遠端分支 (<code>refs/heads/*</code>)，取回之後放入「目的參照規格」的那些本地追蹤分支(<code>refs/remotes/origin/*</code>)。</p>
<p>我們要怎樣查詢遠端儲存庫到底有哪些分支呢？你可以執行 <code>git ls-remote</code> 或 <code>git ls-remote origin</code> 即可列出所有遠端分支：</p>
<p><img alt="image" src="https://f.cloud.github.com/assets/88981/1408776/0cd78222-3d87-11e3-8f2f-ce6d664262fb.png"></p>
<p>如果你把 fetch 的 refspec 修改成以下這樣，那麼除了 <code>master</code> 以外的遠端分支，就不會被下載了！：</p>
<div class="codehilite"><pre>fetch = +refs/heads/master:refs/remotes/origin/master
</pre></div>


<p>如果你想明確下載特定幾個分支就好，你可以重複定義好幾個不同的 <code>fetch</code> 參照規格 (refspec)，例如：</p>
<div class="codehilite"><pre>[remote &quot;origin&quot;]
       url = https://github.com/doggy8088/sandbox-empty2.git
       fetch = +refs/heads/master:refs/remotes/origin/master
       fetch = +refs/heads/TestBranch:refs/remotes/origin/TestBranch
</pre></div>


<p>另外，在我們透過 <code>git remote add [URL]</code> 建立遠端儲存庫設定時，並沒有 <code>push</code> 參照規格，其預設值如下：</p>
<div class="codehilite"><pre>push = +refs/heads/*:refs/heads/*
</pre></div>


<p>所代表的意思則是，當執行 <code>git push</code> 時，Git 指令會參考這份 <code>push</code> 的參照規格，讓你將本地儲存庫在 <code>refs/heads/*</code> 底下的所有分支與標籤，全部都推送到相對應遠端儲存庫的 <code>refs/heads/*</code> 參照名稱下。</p>
<p>最後，無論你執行 <code>git push</code> 或 <code>git fetch</code>，在不特別加參數的情況下，Git 預設就是用 <code>origin</code> 當成遠端儲存庫，並使用 <code>origin</code> 的參照規格。</p>
<h2 id="_4">本地分支與遠端儲存庫之間的關係</h2>
<p>我們已經知道，一個工作目錄下的本地儲存庫，可能會定義有多個遠端儲存庫。所以當你想將 <strong>非 <code>master</code> 分支</strong> 透過 <code>git push</code> 推送到遠端時，Git 可能不知道你到底想推送到哪裡，所以我們要另外定義本地分支與遠端儲存庫之間的關係。</p>
<p>我們以 <code>https://github.com/doggy8088/frontend-tools.git</code> 這個遠端儲存庫為例，我複製下來後，預設就會有一個 <code>master</code> 本地分支，我嘗試建立一個 <code>FixForCRLF</code> 本地分支，直接透過 <code>git push</code> 無法推送成功，你必須輸入完整的 <code>git push origin FixForCRLF</code> 指令才能將本地分支推送上去，原因就出在你並沒有設定「本地分支」與「遠端儲存庫」之間的預設對應。</p>
<p><img alt="image" src="https://f.cloud.github.com/assets/88981/1405857/0425ab54-3d41-11e3-953b-faa3fbe6cd8c.png"></p>
<p>要將<strong>本地分支</strong>建立起跟<strong>遠端儲存庫</strong>的對應關係，只要在 <code>git push</code> 的時候加上 <code>--set-upstream</code> 參數，即可將本地分支註冊進 <code>.git\config</code> 設定檔，之後再用 <code>git push</code> 就可以順利的自動推送上去。</p>
<p><img alt="image" src="https://f.cloud.github.com/assets/88981/1405874/cd6e0c9a-3d41-11e3-843c-f1cc78a11cdf.png"></p>
<p>執行 <code>git push --set-upstream origin FixForCRLF</code> 的同時，會在 <code>.git\config</code> 設定檔增加以下內容：</p>
<div class="codehilite"><pre>[branch &quot;FixForCRLF&quot;]
    remote = origin
    merge = refs/heads/FixForCRLF
</pre></div>


<p>你可以從這個設定檔的格式中發現，在這個 <code>[branch "FixForCRLF"]</code> 設定裡面，有兩個屬性分別是 <code>remote</code> 與 <code>merge</code>，所代表的意思是：「當你想要將本地的 <code>FixForCRLF</code> 分支推送到遠端儲存庫時，預設的遠端儲存庫為 <code>origin</code> 這個，然後推送的時候要將本次的變更合併到 <code>refs/heads/FixForCRLF</code> 這個遠端分支裡。」</p>
<p>當然，我們在一開始執行 <code>git clone https://github.com/doggy8088/frontend-tools.git</code> 的時候，Git 就會預設幫我們建立好 <code>master</code> 分支的對應關係，所以針對 <code>master</code> 分支進行操作時，不需要額外加上 <code>--set-upstream</code> 就能使用。其分支的定義內容如下：</p>
<div class="codehilite"><pre>[branch &quot;master&quot;]
    remote = origin
    merge = refs/heads/master
</pre></div>


<h2 id="_5">今日小結</h2>
<p>本篇文章詳細的介紹，在面對遠端儲存庫時的一些重要觀念，尤其是參照規格 (refspec) 這一段,學會之後才有機會設定更加符合自己或團隊需要的設定。不過，還是建議大家不要修改預設值，以免把大家搞糊塗了。</p>
<p>我重新整理一下本日學到的 Git 指令與參數：</p>
<ul>
<li>git remote -v</li>
<li>git branch -r</li>
<li>git branch -a</li>
<li>git branch</li>
<li>git push</li>
<li>git ls-remote</li>
</ul>
        </article>
      </div>
    </div>
  </body>
</html>
